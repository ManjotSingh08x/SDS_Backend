<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Admin - Menu</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
            <a class="navbar-brand" href="/admin">Admin</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/admin/users">Users</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin/orders">Orders</a>
                    </li>
                    <li class="'nav-item">
                        <a class="nav-link active" href="/admin/menu">Menu</a>
                    </li>
                </ul>
            </div>
        </nav>
        <div class="accordion" id="accordionExample">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button
                        class="accordion-button"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseOne"
                        aria-expanded="true"
                        aria-controls="collapseOne"
                    >
                        Primary Categories Table
                    </button>
                </h2>
                <div
                    id="collapseOne"
                    class="accordion-collapse collapse"
                    data-bs-parent="#accordionExample"
                >
                    <div class="accordion-body">
                        <button
                            class="btn btn-primary mb-2"
                            onclick="togglePrimaryCategory()"
                        >
                            Add Category
                        </button>
                        <div id="addPrimaryForm" class ="w-25 mb-2 " style="display: none">
                            <form id="newPrimaryForm">
                                <div class="mb-2">
                                    <label
                                        for="category_name"
                                        class="'form-label"
                                    ></label>
                                    <input
                                        type="text"
                                        class="form-control"
                                        name="category_name"
                                        id="category_name"
                                    />
                                </div>
                                <button type="submit" class="btn btn-success">
                                    Submit
                                </button>
                            </form>
                        </div>
                        <% if (primary && primary.length > 0) { %>
                        <table class="table table-bordered table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>Category Id</th>
                                    <th>Category Name</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <% primary.forEach(primary => { %>
                                <tr>
                                    <td><%= primary.category_id %></td>
                                    <td><%= primary.category_name %></td>
                                    <td>
                                        <button
                                            onclick="deletePrimary('<%= primary.category_id %>')"
                                            class="btn btn-danger btn-sm"
                                        >
                                            Delete
                                        </button>
                                    </td>
                                </tr>
                                <% }); %>
                            </tbody>
                        </table>
                        <% } else { %>
                        <div class="alert alert-info">No menu items found.</div>
                        <% } %>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button
                        class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseTwo"
                        aria-expanded="false"
                        aria-controls="collapseTwo"
                    >
                        Secondary Categories Table
                    </button>
                </h2>
                <div
                    id="collapseTwo"
                    class="accordion-collapse collapse"
                    data-bs-parent="#accordionExample"
                >
                    <div class="accordion-body">
                        <button
                            class="btn btn-primary mb-2"
                            onclick="toggleSecondaryCategory()"
                        >
                            Add Category
                        </button>
                        <div id="addSecondaryForm" class ="w-25 mb-2 " style="display: none">
                            <form id="newSecondaryForm">
                                <div class="mb-2">
                                    <label
                                        for="category_name"
                                        class="'form-label"
                                    ></label>
                                    <input
                                        type="text"
                                        class="form-control"
                                        name="category_name"
                                        id="category_name"
                                    />
                                </div>
                                <button type="submit" class="btn btn-success">
                                    Submit
                                </button>
                            </form>
                        </div>
                        <% if (secondary && secondary.length > 0) { %>
                        <table class="table table-bordered table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>Category Id</th>
                                    <th>Category Name</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <% secondary.forEach(secondary => { %>
                                <tr>
                                    <td><%= secondary.category_id %></td>
                                    <td><%= secondary.category_name %></td>
                                    <td>
                                        <button
                                            onclick="deleteSecondary('<%= secondary.category_id %>')"
                                            class="btn btn-danger btn-sm"
                                        >
                                            Delete
                                        </button>
                                    </td>
                                </tr>
                                <% }); %>
                            </tbody>
                        </table>
                        <% } else { %>
                        <div class="alert alert-info">
                            No secondary categories found.
                        </div>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
        <div class="container mt-4">
            <h2 class="mb-4">All Menu Items</h2>

            <% if (menu && menu.length > 0) { %>
            <table class="table table-bordered table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Item Id</th>
                        <th>Item Name</th>
                        <th>Price</th>
                        <th>Image</th>
                        <th>Primary Category</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <% menu.forEach(menu => { %>
                    <tr>
                        <td><%= menu.item_id %></td>
                        <td><%= menu.item_name %></td>
                        <td><%= menu.price %></td>
                        <td><%= menu.image_url %></td>
                        <td><%= menu.primary_category_id %></td>
                        <td>
                            <button
                                onclick="viewDetails('<%= menu.item_id %>')"
                                class="btn btn-info btn-sm"
                            >
                                Details
                            </button>
                            <button
                                onclick="deleteMenuItem('<%= menu.item_id %>')"
                                class="btn btn-danger btn-sm"
                            >
                                Delete
                            </button>
                        </td>
                    </tr>
                    <% }); %>
                </tbody>
            </table>
            <% } else { %>
            <div class="alert alert-info">No menu items found.</div>
            <% } %>
            <button class="btn btn-primary" onclick="toggleAddMenuForm()">
                Add Menu Item
            </button>
            <!-- Hidden Add User Form -->
            <div
                id="addMenuItemForm"
                class="card p-3 mb-4"
                style="display: none"
            >
                <h5>Add New Menu Item</h5>
                <form id="newItemForm">
                    <div class="mb-2">
                        <label for="item_name" class="form-label"
                            >Item Name</label
                        >
                        <input
                            type="text"
                            class="form-control"
                            id="item_name"
                            name="item_name"
                            required
                        />
                    </div>
                    <div class="mb-2">
                        <label for="price" class="form-label"
                            >Price</label
                        >
                        <input
                            type="number"
                            id="price"
                            class="form-control"
                            name="price"
                            required
                        />
                    </div>
                    <div class="mb-2">
                        <label for="image_url" class="form-label">Image URL</label>
                        <input
                            type="text"
                            class="form-control"
                            name="image_url"
                            id="image_url"
                            required
                        />
                    </div>
                    <div class="mb-2">
                        <label for="primary category" class="form-label">Primary Category</label>
                        <select class="form-select" name="primary_category_id" id="primary_category">
                            <% primary.forEach(element => {%>
                                <option value="<%= element.category_id %>"><%= element.category_name %></option>
                            <%}); %>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        Add Menu Item
                    </button>
                </form>
            </div>
        </div>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
            crossorigin="anonymous"
        ></script>
        <script src="/js/admin-menu.js"></script>
    </body>
</html>
